# Ansible Configuration
# Version: 3.0.0 Refactored

[defaults]
# Core Paths
inventory = inventory/hosts.yml
roles_path = roles
collections_path = collections
# log_path = /var/log/vps-setup-ansible.log
# Use /tmp for remote temporary files to avoid permission issues when switching users
remote_tmp = /tmp/.ansible-${USER}/tmp
local_tmp = ~/.ansible/tmp

# Mitogen Configuration for Speed
# Using mitogen_linear ensures tasks run sequentially per-role (safe)
# Vendored in plugins/mitogen to ensure portability across users (root/racoondev)
strategy_plugins = plugins/mitogen/ansible_mitogen/plugins/strategy
strategy = mitogen_linear

# Output & Logging (community.general.yaml removed in v12, use builtin default with yaml format)
stdout_callback = ansible.builtin.default
callback_result_format = yaml
bin_ansible_callbacks = True
display_skipped_hosts = True
deprecation_warnings = True
command_warnings = True
system_warnings = True

# Performance
forks = 10
pipelining = True
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts_cache
fact_caching_timeout = 86400

# Security & Execution
host_key_checking = False
timeout = 30
remote_user = root
retry_files_enabled = False

[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False

[ssh_connection]
ssh_args = -o ControlMaster=auto -o ControlPersist=300s -o ServerAliveInterval=60
control_path = /tmp/ansible-ssh-%%h-%%p-%%r
pipelining = True
